# –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∑–∫–∏ Snapshots –≤ HyperspaceDB

## –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞ HyperspaceDB –∑–∞–≥—Ä—É–∂–∞–µ—Ç snapshot —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ, —á—Ç–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç —Å—Ç–∞—Ä—Ç —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ–µ –≤—Ä–µ–º—è. –î–ª—è 597,870 —É–∑–ª–æ–≤ –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–∂–µ—Ç –∑–∞–Ω–∏–º–∞—Ç—å –º–∏–Ω—É—Ç—ã, –ø–æ—Ç—Ä–µ–±–ª—è—è 100% CPU.

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```rust
// hyperspace-server/src/collection.rs:69
let (_store, index, recovered_count) = if snap_path.exists() {
    let store = Arc::new(VectorStore::new(&data_dir, element_size));
    match HnswIndex::<N, M>::load_snapshot(&snap_path, store.clone(), mode, config.clone()) {
        // –°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤–µ—Å—å –ø—Ä–æ—Ü–µ—Å—Å
    }
}
```

## –£–∑–∫–∏–µ –º–µ—Å—Ç–∞

### 1. **–î–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è HNSW –≥—Ä–∞—Ñ–∞ (–ª–∏–Ω–∏—è 110-126)**
```rust
// hyperspace-index/src/lib.rs:110-126
let archived = rkyv::check_archived_root::<SnapshotData>(&file_content)
    .map_err(|e| format!("Snapshot corruption: {}", e))?;
let deserialized: SnapshotData = archived.deserialize(&mut rkyv::Infallible).unwrap();

// Reconstruction of graph - O(N) –æ–ø–µ—Ä–∞—Ü–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É–∑–ª–∞
for s_node in deserialized.nodes {
    let mut layers = Vec::new();
    for s_layer in s_node.layers {
        layers.push(RwLock::new(s_layer)); // –û–±–µ—Ä—Ç–∫–∞ –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ—è
    }
    nodes.push(Node { id: s_node.id, layers });
}
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- –ß—Ç–µ–Ω–∏–µ –≤—Å–µ–≥–æ —Ñ–∞–π–ª–∞ –≤ –ø–∞–º—è—Ç—å (`std::fs::read`)
- –í–∞–ª–∏–¥–∞—Ü–∏—è archived –¥–∞–Ω–Ω—ã—Ö
- –î–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è + —Å–æ–∑–¥–∞–Ω–∏–µ Vec + RwLock –¥–ª—è –ö–ê–ñ–î–û–ì–û —É–∑–ª–∞ –∏ –ö–ê–ñ–î–û–ì–û —Å–ª–æ—è

### 2. **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞**
–ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ `CollectionImpl::new()`, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ.

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### ‚≠ê –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ñ–æ–Ω–æ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞

**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–ø—É—Å–∫–∞—Ç—å —Å–µ—Ä–≤–µ—Ä –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –≤ "read-only" —Ä–µ–∂–∏–º–µ, –∑–∞–≥—Ä—É–∂–∞—Ç—å snapshot –≤ —Ñ–æ–Ω–µ.

```rust
// collection.rs
pub async fn new_async(...) -> Result<Self, String> {
    // 1. –°–æ–∑–¥–∞—Ç—å –ø—É—Å—Ç–æ–π –∏–Ω–¥–µ–∫—Å
    let store = Arc::new(VectorStore::new(&data_dir, element_size));
    let index = Arc::new(HnswIndex::new(store.clone(), mode, config.clone()));
    
    // 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ñ–æ–Ω–æ–≤—É—é –∑–∞–≥—Ä—É–∑–∫—É
    let index_clone = index.clone();
    let snap_path_clone = snap_path.clone();
    tokio::spawn(async move {
        println!("‚è≥ Loading snapshot in background...");
        if let Ok(loaded_index) = HnswIndex::load_snapshot(&snap_path_clone, ...) {
            // –ó–∞–º–µ–Ω–∏—Ç—å –∏–Ω–¥–µ–∫—Å –∞—Ç–æ–º–∞—Ä–Ω–æ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Arc::swap
            println!("‚úÖ Snapshot loaded: {} nodes", loaded_index.count_nodes());
        }
    });
    
    // 3. –°–µ—Ä–≤–µ—Ä –≥–æ—Ç–æ–≤ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ
    Ok(Self { index, ... })
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –°–µ—Ä–≤–µ—Ä —Å—Ç–∞—Ä—Ç—É–µ—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
- ‚úÖ –ú–æ–∂–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏ —Å—Ä–∞–∑—É
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ö†Ô∏è –°—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ (–º–æ–∂–Ω–æ –æ—Ç–¥–∞–≤–∞—Ç—å 503 Service Unavailable –¥–ª—è –ø–æ–∏—Å–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤)

---

### ‚≠ê –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: –õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (Lazy Loading)

**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–≥—Ä—É–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –≥—Ä–∞—Ñ–∞, –≤–µ–∫—Ç–æ—Ä—ã –ø–æ–¥–≥—Ä—É–∂–∞—Ç—å –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é.

```rust
pub struct LazyNode {
    id: NodeId,
    layers: Vec<RwLock<Vec<u32>>>, // Topology - –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É
    vectors_loaded: AtomicBool,     // –§–ª–∞–≥ –∑–∞–≥—Ä—É–∑–∫–∏ –≤–µ–∫—Ç–æ—Ä–æ–≤
}

impl HnswIndex {
    pub fn load_snapshot_lazy(...) -> Result<Self, String> {
        // 1. –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç–æ–ª—å–∫–æ topology (—Å–≤—è–∑–∏ –º–µ–∂–¥—É —É–∑–ª–∞–º–∏)
        let topology = load_topology_only(&file_content)?;
        
        // 2. –í–µ–∫—Ç–æ—Ä—ã –æ—Å—Ç–∞—é—Ç—Å—è –Ω–∞ –¥–∏—Å–∫–µ (mmap)
        // 3. –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –ø–æ–∏—Å–∫–µ - –ø–æ–¥–≥—Ä—É–∂–∞—é—Ç—Å—è –Ω—É–∂–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã
        
        println!("‚úÖ Loaded topology: {} nodes (vectors lazy)", nodes.len());
        Ok(...)
    }
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (–∑–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–ª—å–∫–æ —Ç–æ–ø–æ–ª–æ–≥–∏–∏)
- ‚úÖ –ú–µ–Ω—å—à–µ –ø–∞–º—è—Ç–∏ –Ω–∞ —Å—Ç–∞—Ä—Ç–µ
- ‚úÖ –í–µ–∫—Ç–æ—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç mmap

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ö†Ô∏è –ü–µ—Ä–≤—ã–µ –ø–æ–∏—Å–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã –º–µ–¥–ª–µ–Ω–Ω–µ–µ (cold start)

---

### ‚≠ê –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3: –ü–æ—Ç–æ–∫–æ–≤–∞—è –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `rkyv` zerocopy –±–µ–∑ –ø–æ–ª–Ω–æ–π –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏.

```rust
pub fn load_snapshot_zerocopy(...) -> Result<Self, String> {
    // 1. Mmap —Ñ–∞–π–ª–∞ snapshot –≤–º–µ—Å—Ç–æ –ø–æ–ª–Ω–æ–≥–æ —á—Ç–µ–Ω–∏—è
    let file = File::open(path)?;
    let mmap = unsafe { MmapOptions::new().map(&file)? };
    
    // 2. Zero-copy –¥–æ—Å—Ç—É–ø –∫ archived –¥–∞–Ω–Ω—ã–º
    let archived = rkyv::check_archived_root::<SnapshotData>(&mmap)?;
    
    // 3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å archived –¥–∞–Ω–Ω—ã–µ –Ω–∞–ø—Ä—è–º—É—é
    // –ù–ï –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å –≤—Å—ë —Å—Ä–∞–∑—É
    let nodes = archived.nodes.iter().map(|s_node| {
        // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è
        Node {
            id: s_node.id,
            layers: s_node.layers.iter()
                .map(|l| RwLock::new(l.as_slice().to_vec()))
                .collect()
        }
    }).collect();
    
    Ok(...)
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ù–µ—Ç –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ë—ã—Å—Ç—Ä–µ–µ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è
- ‚úÖ –ú–µ–Ω—å—à–µ –∞–ª–ª–æ–∫–∞—Ü–∏–π

---

### ‚≠ê –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 4: –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ —Å–Ω–∞–ø—à–æ—Ç—ã

**–†–µ—à–µ–Ω–∏–µ:** –í–º–µ—Å—Ç–æ –º–æ–Ω–æ–ª–∏—Ç–Ω–æ–≥–æ snapshot –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å delta updates.

```rust
// –°–æ—Ö—Ä–∞–Ω—è—Ç—å —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ snapshot
pub struct IncrementalSnapshot {
    base_snapshot_id: u64,
    new_nodes: Vec<Node>,        // –î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ —É–∑–ª—ã
    updated_nodes: Vec<NodeId>,  // ID –∏–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö —É–∑–ª–æ–≤
    deleted_nodes: Vec<NodeId>,  // –£–¥–∞–ª–µ–Ω–Ω—ã–µ —É–∑–ª—ã
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ú–∞–ª–µ–Ω—å–∫–∏–µ —Ñ–∞–π–ª—ã delta
- ‚úÖ –ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–µ–ª—å—Ç
- ‚úÖ –ú–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω—è—Ç—å –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ

---

### ‚≠ê –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 5: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è

**–†–µ—à–µ–Ω–∏–µ:** –†–∞–∑–±–∏—Ç—å snapshot –Ω–∞ —á–∞–Ω–∫–∏, –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ.

```rust
pub fn load_snapshot_parallel(...) -> Result<Self, String> {
    let chunks = split_snapshot_into_chunks(&file_content, num_cpus::get());
    
    let nodes: Vec<Node> = chunks.par_iter()
        .flat_map(|chunk| deserialize_chunk(chunk))
        .collect();
    
    Ok(...)
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å–µ CPU cores
- ‚úÖ –ë—ã—Å—Ç—Ä–µ–µ –Ω–∞ –±–æ–ª—å—à–∏—Ö snapshot'–∞—Ö

---

### ‚≠ê –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 6: –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –∏ —Ç–∞–π–º–∞—É—Ç—ã

**–†–µ—à–µ–Ω–∏–µ:** –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏, –¥–æ–±–∞–≤–∏—Ç—å —Ç–∞–π–º–∞—É—Ç.

```rust
pub fn load_snapshot_with_progress(...) -> Result<Self, String> {
    let total_nodes = get_node_count_from_header(&file_content)?;
    
    println!("‚è≥ Loading snapshot: 0/{} nodes...", total_nodes);
    
    for (i, s_node) in deserialized.nodes.iter().enumerate() {
        if i % 10000 == 0 {
            println!("‚è≥ Progress: {}/{} nodes ({:.1}%)", 
                i, total_nodes, (i as f64 / total_nodes as f64) * 100.0);
        }
        // Deserialize node...
    }
    
    println!("‚úÖ Loaded {} nodes", total_nodes);
    Ok(...)
}
```

---

## –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –§–∞–∑–∞ 1: –ë—ã—Å—Ç—Ä—ã–µ –ø–æ–±–µ–¥—ã (1-2 –¥–Ω—è)
1. ‚úÖ **–ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä** - –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–≥—Ä—É–∑–∫–∏
2. ‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏** - –∏–∑–º–µ—Ä–∏—Ç—å –∫–∞–∂–¥—ã–π —ç—Ç–∞–ø
3. ‚úÖ **mmap –¥–ª—è —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞** - –≤–º–µ—Å—Ç–æ `std::fs::read`

### –§–∞–∑–∞ 2: –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (3-5 –¥–Ω–µ–π)
4. ‚úÖ **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ñ–æ–Ω–æ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞** - –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—Ç
5. ‚úÖ **Zerocopy –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å archived –¥–∞–Ω–Ω—ã–µ –Ω–∞–ø—Ä—è–º—É—é

### –§–∞–∑–∞ 3: –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (1-2 –Ω–µ–¥–µ–ª–∏)
6. ‚úÖ **–ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ snapshots** - –¥–µ–ª—å—Ç–∞-–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
7. ‚úÖ **–õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –≤–µ–∫—Ç–æ—Ä–æ–≤** - topology first, vectors on demand
8. ‚úÖ **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å–µ CPU

---

## –ö–æ–¥ –¥–ª—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è

### –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (10 –º–∏–Ω—É—Ç —Ä–∞–±–æ—Ç—ã):

```rust
// hyperspace-index/src/lib.rs
pub fn load_snapshot(...) -> Result<Self, String> {
    use std::time::Instant;
    let start = Instant::now();
    
    // 1. Read with mmap
    let file = File::open(path).map_err(|e| e.to_string())?;
    let mmap = unsafe { 
        memmap2::MmapOptions::new().map(&file).map_err(|e| e.to_string())? 
    };
    println!("üìÇ Snapshot file mapped: {} bytes", mmap.len());
    
    // 2. Validate
    let archived = rkyv::check_archived_root::<SnapshotData>(&mmap)
        .map_err(|e| format!("Snapshot corruption: {}", e))?;
    println!("‚úì Snapshot validated ({:.2}s)", start.elapsed().as_secs_f64());
    
    // 3. Deserialize with progress
    let deserialized: SnapshotData = archived.deserialize(&mut rkyv::Infallible).unwrap();
    println!("‚úì Deserialized ({:.2}s)", start.elapsed().as_secs_f64());
    
    // 4. Reconstruct graph
    let total = deserialized.nodes.len();
    let mut nodes = Vec::with_capacity(total);
    
    for (i, s_node) in deserialized.nodes.into_iter().enumerate() {
        if i % 50000 == 0 && i > 0 {
            println!("‚è≥ Loading: {}/{} nodes ({:.1}%)", 
                i, total, (i as f64 / total as f64) * 100.0);
        }
        
        let mut layers = Vec::new();
        for s_layer in s_node.layers {
            layers.push(RwLock::new(s_layer));
        }
        nodes.push(Node { id: s_node.id, layers });
    }
    
    storage.set_count(nodes.len());
    println!("‚úÖ Restored {} nodes in {:.2}s", nodes.len(), start.elapsed().as_secs_f64());
    
    Ok(Self { ... })
}
```

---

## –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –∏–∑–º–µ—Ä–µ–Ω–∏—è

–î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:
- ‚è±Ô∏è **–í—Ä–µ–º—è —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞**
- ‚è±Ô∏è **–í—Ä–µ–º—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏**
- ‚è±Ô∏è **–í—Ä–µ–º—è –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏**
- ‚è±Ô∏è **–í—Ä–µ–º—è —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≥—Ä–∞—Ñ–∞**
- üìä **–ü–∞–º—è—Ç—å –¥–æ/–ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏**

–≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≥–ª–∞–≤–Ω–æ–µ —É–∑–∫–æ–µ –º–µ—Å—Ç–æ.

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–ª—è production:**
1. üö® **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞** - —Å–µ—Ä–≤–µ—Ä –Ω–µ –¥–æ–ª–∂–µ–Ω –≤–∏—Å–µ—Ç—å
2. üö® **–ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –≤–∏–¥–µ—Ç—å —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç
3. üö® **Mmap –≤–º–µ—Å—Ç–æ read** - —ç–∫–æ–Ω–æ–º–∏—è –ø–∞–º—è—Ç–∏

**–ò–∑–º–µ—Ä–∏—Ç—å —ç—Ñ—Ñ–µ–∫—Ç:** –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–º–µ—Ä—è—Ç—å –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ 597K —É–∑–ª–æ–≤.

**–¶–µ–ª–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏:**
- –°—Ç–∞—Ä—Ç —Å–µ—Ä–≤–µ—Ä–∞: **&lt;1 —Å–µ–∫—É–Ω–¥–∞** (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞)
- –ó–∞–≥—Ä—É–∑–∫–∞ 1M —É–∑–ª–æ–≤: **&lt;10 —Å–µ–∫—É–Ω–¥** (—Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è–º–∏)
